---
import Layout from "../../layouts/Layout.astro";
import CommandCard from "../../components/CommandCard.svelte";
import ThemeToggle from "../../components/ThemeToggle.svelte";
import { categories } from "../../lib/commands";

export function getStaticPaths() {
    return categories.map((category) => ({
        params: { id: category.id },
        props: { category },
    }));
}

const { category } = Astro.props;
---

<Layout title={`${category.name} - 群指令字典`}>
    <div
        class="min-h-screen bg-gradient-to-br from-amber-50 via-orange-50 to-pink-50 dark:from-slate-900 dark:via-slate-900 dark:to-slate-900"
    >
        <!-- Header -->
        <header
            class="sticky top-0 z-20 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-orange-200 dark:border-slate-700 shadow-md"
        >
            <div class="container mx-auto px-4 py-4 flex items-center justify-between gap-3">
                <div class="flex items-center gap-3">
                    <a
                        href="/"
                        class="p-2 rounded-full hover:bg-orange-100 dark:hover:bg-slate-700 transition-colors text-orange-500 dark:text-orange-400"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-5 w-5"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </a>
                    <div class="flex items-center gap-2">
                        <span class="text-2xl drop-shadow-md">{category.icon}</span>
                        <h1
                            class="text-lg font-bold text-gray-800 dark:text-gray-100"
                        >
                            {category.name}
                        </h1>
                    </div>
                </div>
                <ThemeToggle client:load />
            </div>
        </header>

        <!-- Content -->
        <main class="container mx-auto px-4 py-6">
            <div
                class="mb-4 text-sm text-gray-600 dark:text-gray-400 px-2 bg-white/50 dark:bg-slate-800/50 backdrop-blur-sm rounded-lg p-3 border border-orange-200 dark:border-slate-700"
            >
                {category.description}
            </div>

            <div class="grid gap-4">
                {
                    category.commands.map((command) => (
                        <CommandCard command={command} client:visible />
                    ))
                }
            </div>
        </main>

        <!-- Back to Top -->
        <button
            id="back-to-top"
            class="fixed bottom-6 right-6 p-4 rounded-full bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-lg hover:shadow-xl transition-all hover:scale-110 active:scale-95 hidden"
            aria-label="返回顶部"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
            </svg>
        </button>
    </div>
</Layout>

<script>
    // Back to top button
    const backToTop = document.getElementById("back-to-top");

    function toggleBackToTop() {
        if (window.scrollY > 300) {
            backToTop?.classList.remove("hidden");
        } else {
            backToTop?.classList.add("hidden");
        }
    }

    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
    }

    window.addEventListener("scroll", toggleBackToTop);
    backToTop?.addEventListener("click", scrollToTop);
</script>
